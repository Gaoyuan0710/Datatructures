_.Module.define({path:"frs/widget/forum_card/focus_btn",sub:{initial:function(d){var a=this,b=$("#j_head_focus_btn"),c=null;a.config={};a.config.url={closetip:"/f/like/commit/notice/delete",dolike:"/f/like/commit/add",undolike:"/f/like/commit/delete"};if(!parseInt(d.islike)){c=function(){a._dolike()}}else{c=function(){var f=PageData.forum_name||PageData.forum.forum_name;f=$.tb.subByte(f,10,"...");var e=['<div style="width:190px;text-align:center;top:18px;left:10px;position:absolute;">\u786e\u5b9a\u4e0d\u518d\u5173\u6ce8 <span style="color:red">'+f+"</span> \u5427\uff1f</div>",'<a href="#" id="cancel_focus_yes" class=" ui_btn ui_btn_s" style="position:absolute;top:50px;left:55px;">',"<span><em>\u786e\u8ba4</em></span>","</a>",'<a href="#" onclick="return false;" id="cancel_focus_no" class="ui_btn ui_btn_sub_s" style="position:absolute;top:50px;left:105px;">',"<span><em>\u53d6\u6d88</em></span>","</a>"].join("");var g=new $.dialog({html:e,showTitle:false,fixed:false,show:true,draggable:false,autoCenter:false,modal:false,top:$("#j_head_focus_btn").offset().top-$(this).height()/2-90,left:$("#j_head_focus_btn").offset().left-$(this).width()/2+15,width:210,height:70});$("#cancel_focus_yes").on("click",function(){a._undolike();g.close()});$("#cancel_focus_no").on("click",function(){g.close()})}}b.on("click",c)},_showAlert:function(b){var a='<div style="padding:20px 20px; text-align:cente; line-height:20px;font-size:13px;">'+b+"</div>";$.dialog.open(a,{title:"\u64cd\u4f5c\u5931\u8d25",width:380})},_dolike:function(){var a=this;if(!PageData.user.is_login){TbCom.process("User","buildLoginFrame");return false}if(PageData.user.is_login&&PageData.user.no_un){TbCom.process("User","buildUnameFrame","\u586b\u5199\u7528\u6237\u540d","\u6709\u7528\u6237\u540d\u624d\u80fd\u70b9\u4eae\u201c\u6211\u559c\u6b22\u201d\uff0c\u8d76\u5feb\u7ed9\u81ea\u5df1\u8d77\u4e00\u4e2a\u5427~");return false}var b={};if(PageData.forum){b={fid:PageData.forum.id,fname:PageData.forum.forum_name||PageData.forum_name,uid:PageData.user.name_url,ie:"gbk",tbs:PageData.tbs}}$.post(a.config.url.dolike,b,function(g){var c=false;try{var d=g}catch(e){c=true}if(c){return}if(d&&d.no==0){Stats.sendRequest("fr=tb0_foruStatm&st_mod=frs&st_type=balvlikesucc&bduid="+PageData.user.bduid);_.Module.use("ucenter/component/LikeTip",["",false,{index:d.data.ret.index,like_no:d.like_no}]);$.stats.sendRequest("fr=tb0_forum&st_page=frs&st_mod=like&st_type=auto")}else{Stats.sendRequest("fr=tb0_foruStatm&st_mod=frs&st_type=balvlikefail&errorno="+d.no);var f="";if(d.no==8||d.no==9){f="\u4f60\u5728\u672c\u5427\u88ab\u5c01\u7981\uff0c\u6682\u65f6\u4e0d\u80fd\u8fdb\u884c\u64cd\u4f5c"}else{if(d.no==220){f="\u4f60\u88ab\u5427\u4e3b\u52a0\u5165\u9ed1\u540d\u5355\uff0c\u6682\u65f6\u4e0d\u80fd\u8fdb\u884c\u64cd\u4f5c"}else{if(d.no==221){f="\u4f60\u5df2like\u4e86\u672c\u5427,\u8bf7\u4e0d\u8981\u91cd\u590d\u64cd\u4f5c"}else{f="\u62b1\u6b49\uff0c\u5f02\u5e38\u9519\u8bef\uff0c\u5efa\u8bae\u5237\u65b0\u9875\u9762\u91cd\u8bd5\u4e00\u4e0b"}}}a._showAlert(f)}},"json")},_undolike:function(){var a=this,b=null;if(PageData.forum){b={fid:PageData.forum.id,fname:PageData.forum.name_url,uid:PageData.user.name_url,ie:"utf-8",tbs:PageData.tbs}}$.tb.post(a.config.url.undolike,b,function(f){var c=false;try{var d=f}catch(e){c=true}if(c){return}if(d&&d.no==0){$.tb.location.reload(true)}else{}})}}});